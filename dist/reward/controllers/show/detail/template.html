<div class="reward-detail reward-detail-pin">
	<div class="zs-bar tc">
		<a [routerLink]="['/']" class="zs-back"></a>
		{{info?.cRPName}}
		<a class="pull-xs-right" [routerLink]="['/show/edit',{id:id}]">编辑</a>
		<a class="pull-xs-right" (click)="onDelete()">删除</a>
		<a class="pull-xs-right" (click)="onState()">{{info?.cRPStatus===1?'发放中':'暂停中'}}</a>
	</div>
	<div class="rd-main">
		<div class="rx-col">
			<div class="zs-border rx-main">
				<h1>明细查询</h1>
				<div class="rx-search">
					<div class="rx-condition">
						<div class="rx-cond-label">发放日期</div>
						<div class="th-datepicker-block">
							<div class="rd-btn" [class.active]="prizesParams.range===-1" (click)="onSetRange()">全部</div>
							<div class="s-input tc th-datepicker-range" >
								<input type="text" readonly (click)="onShowDate($event)" name="name" class="inputtxt" [value]="prizesParams.startDate+'~'+prizesParams.endDate" style="width:100%" value="">
								<div class="tc th-datepicker-tip" (click)="$event.stopPropagation()" *ngIf="dateShow" >
									<div class="th-datepicker" >
										<datepicker [ngModel]="prizesParams.startDate" (ngModelChange)="prizesParams.startDate = moment($event)"  [showWeeks]="true"></datepicker>
									</div>
									<div class="th-datepicker">
										<datepicker [ngModel]="prizesParams.endDate" (ngModelChange)="prizesParams.endDate = moment($event)" [showWeeks]="true"></datepicker>
									</div>
								</div>
							</div>
							<div class="rd-btn" [class.active]="prizesParams.range===7" (click)="onSetRange(7)">本周</div>
							<div class="rd-btn" [class.active]="prizesParams.range===30" (click)="onSetRange(30)">本月</div>
							<div class="rd-btn" [class.active]="prizesParams.range===90" (click)="onSetRange(90)">本季度</div>
							<div class="rd-btn" [class.active]="prizesParams.range==='currentYear'" (click)="onSetRange('currentYear')">2015</div>
							<div class="rd-btn" [class.active]="prizesParams.range==='nextYear'" (click)="onSetRange('nextYear')">2016</div>
						</div>
					</div>

					<div class="rx-condition">
						<div class="rx-cond-label">关联项目</div>
						<div>
							<div class="s-input">
								<select [(ngModel)]="prizesParams.projectId">
									<option [value]="pl.cPId" *ngFor="let pl of projectsList">{{pl.cPName}}</option>
								</select>
							</div>
						</div>
					</div>
					<div class="rx-cond-op">
						<button class="rd-btn" (click)="onSearch()">查找</button>
					</div>
				</div>
				<div class="rx-list">
					<table class="table">
						<caption>
							数据列表
							<a target="_blank" [href]="onDownload()" class="zs-btn-export fr">导出数据</a>
						</caption>
						<thead>
							<tr>
								<th>序号</th>
								<th>发放时间</th>
								<th >发放来源
									<div class="zs-b-des">
										<i></i>
										<div>
											此处显示的是获奖链接的原始部署对象，如门店、员工或商品。
										</div>
									</div>
								</th>
								<th>获奖手机号</th>
							</tr>
						</thead>
						<tbody *ngIf="prizesList">
							<tr *ngFor="let psl of prizesList;let i = index;">
								<td>{{i+1}}</td>
								<td>{{psl.cRSendTime}}</td>
								<td>{{psl.groupName}}{{psl.cREntityName}}</td>
								<td>{{psl.cRMobile}}</td>
							</tr>
						</tbody>
					</table>
					<div class="rx-list-empty tc c-pink re-hide" *ngIf="!prizesList">
						未查找到有效数据
					</div>
					<pagination [totalItems]="pageCount" [(ngModel)]="currentPage" [itemsPerPage]="pageSize" class="pagination-sm"
                [boundaryLinks]="true" [rotate]="false" (numPages)="numPages = $event" firstText="首页" lastText="结束页" previousText="上一页" nextText="下一页"></pagination>
				</div>
			</div>
			<div class="zs-border rx-side">
				<div class="s-header tc">
					<h1>{{info?.cRPName}}</h1>
					<p>创建时间<span>{{info?.cRPCreateDate|date:'YYYY-MM-DD'}}</span></p>
				</div>
				<div class="s-items">
					<div class="s-item" *ngFor="let tl of totalList">
						<div>
							<span>展示码总量</span>
							<span class="c-blue">{{tl.totalNum}}</span>
							<span class="s-ico  s-ico-add"></span>
						</div>
						<div>
							<span>已发放总量</span>
							<span class="c-green">{{tl.senderNum}}</span>
							<a class="s-ico s-ico-down" [href]="onDoneDownload()"></a>
						</div>
					</div>
				</div>
				<div class="s-rel">
					<div class="s-rel-title">当前项目关联</div>
					<div>
						<a *ngFor="let cpl of curProjectsList">{{cpl.cPName}}</a>
					</div>
				</div>
			</div>
		</div>
		<div class="rd-footer tc">
			2006-2016 All rights reserved 上海皓煦数据技术有限公司 沪ICP备08012157号-5
		</div>
	</div>

</div>
